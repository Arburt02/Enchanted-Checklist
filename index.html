<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Enchanted Checklist</title>
  <style>
  body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    background: linear-gradient(to bottom, #b0ddf4, #6fb2dc, #2f77a7);
    background-attachment: fixed;
    background-repeat: no-repeat;
    background-size: cover;
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 2rem;
    min-height: 100vh;
  }

  h1 {
    font-size: 2rem;
    margin-bottom: 1rem;
  }

  input, button {
    margin: 0.5rem 0;
    padding: 0.6rem;
    border: none;
    border-radius: 8px;
    font-size: 1rem;
  }

  input {
    width: 220px;
  }

  button {
    background-color: white;
    color: #2f77a7;
    cursor: pointer;
    font-weight: bold;
  }

  #main-menu button {
    font-size: 1rem;
    padding: 0.75rem 1.25rem;
    margin: 0.5rem;
    border: none;
    border-radius: 10px;
    background-color: #ffffff;
    color: #2f77a7;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.2s ease;
  }

  #main-menu button:hover {
    background-color: #e0f0fa;
  }

  #checklistArea {
    margin-top: 2rem;
    display: none;
  }
  </style>
</head>
<body>
  <h1>‚ú® The Enchanted Checklist</h1>
  <div id="authSection">
    <input type="email" id="email" placeholder="Email" /><br />
    <input type="password" id="password" placeholder="Password" /><br />
    <button onclick="login()">Login</button>
    <button onclick="register()">Register</button>
  </div>

  	<div id="checklistArea">
    <!-- Inside index.html, within <body> after user logs in -->
	<div id="app">
		
  <!-- üß≠ Welcome Message -->
  	<div id="welcome-message" style="margin-bottom: 2rem;">
    <h2>Welcome to ‚ú® The Enchanted Checklist</h2>
    <p>
      Whether you're visiting for the first time or the fiftieth, there's always something magical left to discover. 
      This checklist was built with a lifelong passion for Disney ‚Äî a place where adventure lives in every corner and 
      no two trips are ever the same. Walt Disney once said that Disneyland will never be completed, and your journey 
      through the parks can be just as imaginative and ever-changing.
    </p>
  	</div>

  <!-- üî¢ Global Progress Bar -->
	<div id="global-progress" style="margin-top: 1rem; width: 100%; max-width: 600px;">
  	<label style="display: block; font-weight: bold; margin-bottom: 0.25rem;">Overall Progress</label>
  	<div style="background: rgba(255,255,255,0.2); border-radius: 8px; height: 16px; overflow: hidden;">
    <div id="progress-bar" style="height: 100%; width: 0%; background: linear-gradient(to right, #deb6ee, #dc81ff, #c075e4); transition: width 0.3s;"></div>
  	</div>
  	<p id="progress-text" style="margin-top: 0.25rem; font-size: 0.9rem;"></p>
	</div>

	<div id="experiencesView" style="display: none; margin-top: 2rem;">
  	<h2>Your Experiences</h2>
  	<div id="experience-list" style="display: flex; flex-direction: column; gap: 1rem;">
    <!-- Experiences like Walt Disney World, Disneyland, etc., will be injected here -->
  	</div>
	</div>

  <!-- üîò Main Menu Buttons -->
  <div id="main-menu">
    <button onclick="loadExperiences()">üé¢ Your Experiences</button>
    <button onclick="openPreferences()">‚öôÔ∏è Preferences</button>
  </div>
</div>

<!-- Temporary JS hooks -->
<script>
  function loadExperiences() {
  document.getElementById("welcome-message").style.display = "none";
  document.getElementById("global-progress").style.display = "none";
  document.getElementById("main-menu").style.display = "none";
  document.getElementById("experiencesView").style.display = "block";

  const experienceList = document.getElementById("experience-list");
  experienceList.innerHTML = ''; // Clear previous entries

  // For now, hardcoded experience options
  const experiences = [
    { name: "Walt Disney World", icon: "üè∞", id: "wdw" },
    { name: "Disneyland", icon: "üéÜ", id: "dlr" } // Placeholder for later
  ];

  experiences.forEach(exp => {
    const btn = document.createElement('button');
    btn.textContent = `${exp.icon} ${exp.name}`;
    btn.style.padding = '0.75rem 1.25rem';
    btn.style.border = 'none';
    btn.style.borderRadius = '10px';
    btn.style.backgroundColor = '#ffffff';
    btn.style.color = '#2f77a7';
    btn.style.fontWeight = 'bold';
    btn.style.cursor = 'pointer';

    btn.onclick = () => {
      // In next step we'll handle WDW logic here
      window.location.href = 'checklist.html'; // Placeholder for now
    };

    experienceList.appendChild(btn);
  });
}

  function openPreferences() {
    alert("Preferences view coming soon!");
  }
</script>
    <button onclick="logout()">Log out</button>
  </div>
  
  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js";
    import { getAuth, onAuthStateChanged, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDLDycGnK6Nm8m5KqbhhPSKz7GNb3PjZCo",
      authDomain: "the-enchanted-checklist.firebaseapp.com",
      projectId: "the-enchanted-checklist",
      storageBucket: "the-enchanted-checklist.firebasestorage.app",
      messagingSenderId: "971177969419",
      appId: "1:971177969419:web:3a48e119cb866f6551840e",
      measurementId: "G-61WBFLWL40"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // üîí Handle Login
    window.login = async function () {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      try {
        await signInWithEmailAndPassword(auth, email, password);
      } catch (err) {
        alert("Login failed: " + err.message);
      }
    }

    // üßæ Handle Registration
    window.register = async function () {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      try {
        await createUserWithEmailAndPassword(auth, email, password);
      } catch (err) {
        alert("Registration failed: " + err.message);
      }
    }

    // üö™ Handle Logout
    window.logout = function () {
      signOut(auth);
    }

    // üëÄ Watch Auth State
    onAuthStateChanged(auth, user => {
      if (user) {
        document.getElementById("authSection").style.display = "none";
        document.getElementById("checklistArea").style.display = "block";
      } else {
        document.getElementById("authSection").style.display = "block";
        document.getElementById("checklistArea").style.display = "none";
      }
    });
	
	function updateGlobalProgress() {
  // Load checklist JSON
  fetch('checklist.json')
    .then(res => res.json())
    .then(data => {
      const total = data.length;
      let completed = 0;

      // Compare against localStorage keys
      data.forEach(task => {
        const taskId = task.id || `${task.Park}-${task.Area}-${task.Task}`;
        if (localStorage.getItem(taskId) === "complete") {
          completed++;
        }
      });

      const percent = ((completed / total) * 100).toFixed(1);
      document.getElementById("progress-bar").style.width = `${percent}%`;
      document.getElementById("progress-text").textContent = `${percent}% Complete ‚Äî ${completed} / ${total} tasks`;
    });
}

// Call it once on load
updateGlobalProgress();
	
</script>
</body>

</html>